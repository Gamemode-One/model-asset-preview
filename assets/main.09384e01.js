import{W as e,P as t,O as a,S as i,A as s,C as n,c as r,a as o,G as h,B as l,b as d,d as u,V as c,e as m,f as p,r as w,o as g,g as v,h as f,u as R,w as P,v as y,i as M,j as I,F as x,k as j}from"./vendor.a27d5e44.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const i=new URL(e,location),s=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,n)=>{const r=new URL(e,i);if(self[t].moduleMap[r])return a(self[t].moduleMap[r]);const o=new Blob([`import * as m from '${r}';`,`${t}.moduleMap['${r}']=m;`],{type:"text/javascript"}),h=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(o),onerror(){n(new Error(`Failed to import: ${e}`)),s(h)},onload(){a(self[t].moduleMap[r]),s(h)}});document.head.appendChild(h)})),self[t].moduleMap={}}}("/model-asset-preview/assets/");class b{constructor(o,h,l,d){var u;this.canvasElement=o,this.texturePath=l,this.options=d,this.renderingRequested=!1,this.renderer=new e({canvas:o,antialias:null!=(u=d.antialias)&&u,preserveDrawingBuffer:!0,precision:"highp"}),this.renderer.setPixelRatio(window.devicePixelRatio),this.camera=new t(70,1,.1,1e3),this.camera.position.x=-20,this.camera.position.y=20,this.camera.position.z=-20,this.controls=new a(this.camera,o),this.scene=new i,this.scene.add(new s(16777215)),this.scene.background=new n(1184274),this.model=new r(h,l),this.scene.add(this.model.getModel()),window.addEventListener("resize",(()=>this.onResize(!0))),this.controls.addEventListener("change",(()=>this.requestRendering())),this.onResize(!1)}get width(){var e;return null!=(e=this.options.width)?e:window.innerWidth}get height(){var e;return null!=(e=this.options.height)?e:window.innerHeight}render(e=!0){this.controls.update(),this.renderer.render(this.scene,this.camera),this.renderingRequested=!1,e&&this.model.shouldTick&&(this.model.tick(),this.requestRendering())}requestRendering(e=!1){if(e)return this.render(!1);this.renderingRequested||(this.renderingRequested=!0,requestAnimationFrame((()=>this.render())))}onResize(e=!0){this.canvasElement.width=this.width,this.canvasElement.height=this.height,this.renderer.setSize(this.width,this.height,!0),this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix(),e&&this.requestRendering()}addHelpers(){this.scene.add(new o(50)),this.scene.add(new h(20,20)),this.scene.add(new l(this.model.getModel(),16776960)),this.requestRendering()}getModel(){return this.model}positionCamera(e=1.5,t=!0){t&&this.model.getModel().rotation.set(0,Math.PI,0);const a=(new d).setFromObject(this.model.getModel()).getBoundingSphere(new u),i=this.camera.fov*Math.PI/180*e,s=a.radius/Math.tan(i/2),n=Math.sqrt(Math.pow(s,2)+Math.pow(s,2));this.camera.position.set(n,n,n),this.controls.update(),this.camera.lookAt(a.center),this.controls.target.set(a.center.x,a.center.y,a.center.z),this.camera.updateProjectionMatrix()}async generatePreview(e=1.5,t=10){const a=new OffscreenCanvas(1400*t,600*t),i=a.getContext("2d");if(!i)return;i.imageSmoothingEnabled=!1;const s=this.model.getModel();this.positionCamera(e);const n=[];for(let d=0;d<5;d++)1===d&&s.rotateY(Math.PI/4),0!==d&&s.rotateY(Math.PI/2),this.render(!1),n.push(this.canvasElement.toDataURL("image/png"));const r=(new d).setFromObject(this.model.getModel()).getCenter(new c);s.position.setY(r.y),s.rotation.set(.25*Math.PI,1.75*Math.PI,.75*Math.PI),this.positionCamera(e,!1),this.render(!1),n.push(this.canvasElement.toDataURL("image/png")),s.position.setY(0),s.rotation.set(0,1.75*Math.PI,1.75*Math.PI),this.positionCamera(e,!1),this.render(!1),n.push(this.canvasElement.toDataURL("image/png"));const[o,h,...l]=await Promise.all([this.loadImage(this.texturePath),this.loadImage("./gm1.webp"),...n.map((e=>this.loadImage(e)))]);i.fillStyle="#121212",i.fillRect(0,0,a.width,a.height),i.drawImage(l[0],0,100*t,400*t,400*t/this.camera.aspect);for(let d=0;d<3;d++)i.drawImage(l[d+1],650*t,200*d*t,200*t,200*t/this.camera.aspect);for(let d=0;d<3;d++)i.drawImage(l[d+4],1050*t,200*d*t,200*t,200*t/this.camera.aspect);i.drawImage(o,400*t,200*t,200*t,200*t),i.drawImage(h,a.width-50*t,a.height-50*t,50*t,50*t),a.convertToBlob().then((e=>URL.createObjectURL(e))).then((e=>window.open(e)))}loadImage(e){return new Promise((t=>{const a=new Image;a.src=e,a.addEventListener("load",(()=>t(a)))}))}}var E=m({expose:[],props:{texture:String,model:Object,quality:{type:Number,default:10}},emits:["ready"],setup(e,{emit:t}){const a=e,i=p((()=>1e3*a.quality)),s=p((()=>1e3*a.quality)),n=w(void 0);return g((()=>{if(!n.value)return;const e=new b(n.value,a.model,a.texture,{width:i.value,height:s.value,antialias:!0});e.onResize(),e.positionCamera(),setTimeout((async()=>{e.requestRendering(!0),await e.generatePreview(1.5,2*a.quality),t("ready")}),10)})),(e,t)=>(v(),f("canvas",{style:{display:"none",width:R(i),height:R(s)},ref:n},null,4))}});const A=M("img",{alt:"Vue logo",src:"data:image/webp;base64,UklGRjIFAABXRUJQVlA4TCYFAAAvY8AYAD8Ft5EkR1Lk3N1T/8187aVj5QaDto0kuXv8aR2pL5DbRpIkMaq7/bd03jN7av5jVfya6/iIRriAETaZQDjEcQRjSPg3HCPmwZwRiMgYJMMwgjEC4c/FLTdhc4QLEwQhGcZgCiYYHEz+BcEtBGIQwmUYjuEQwUgIGRIeB4QjkxFMMIaEIwcThCUhZDiGC/PXy+uOGEjYYPb8G5hcHj4mE/6QJ7pgOjlduFxxf3Lfm0Nj5x9/hhcElyPnz37u8o6NoUMHI4jz8z8aexGD8cYgFPS3bU/bVvIOJYeTjpcyw5iZ2rinTKOcZPZ4c8fMzMzM+H/OknL1Un/e9b3fF9F/B24jKVIN6ThH6X5D+CPhkbcisI2gCJiNx9linzpEhIQBFhIhYoCJiJhFGGywEbGjyQFap05OiQhPXZVnihl4aisKNKt80tTVrVMZYUBoNXnIxWRgUb0yxqw+YmijfknPLE8BE/4GahbZ2OoXubmRW+vHm1nQw6JnXPOcMgXg118U/mhYjfpxBk99q5OL/lSF5y9v33vFLx8v2yx4zK9ev/+sUJsEvjLwgYBaAlheazxTfSeZ/D1Xjl1++JJvLAvR/piZ339VSBLw+SNAH3SGr6LzTPYDB+lIKVTl/l+qX6AGaEPPXwKIaLGMiqyDFXSkPJRukIVxSufW/WFJwlNSA0gCnhAsWeBky2YUkvt7Zj79pkC1wIf3lgteyfSzTCWwXGDmG8s2b3Sw+S0KvyUrp3yK0wi8s8RD6dApkoyHRJPOw8yP3STffeOJMkbpDHlhMiQEKPX38ZoSDzTzxlunFwoYPnPTwr3uNJlpqAGm+dpv0csMnr7pNJTfPbz24v17BDw4v2xz9J0BAB6cW/afSHu+ELSlv29r9hk8uODkAgobt0anDh6jA3L4RD4EnzooojHwiZNRGGzvSCukslsNnkPHOSy4uCBZf11uD+VoT7QpH/D6HJHGwMAaX/r9EuWl26w8+cCFJ1fOzpS2dBFAIQLqbClNE2IGgKZO4vlzMp5K+zssPC5OwNe8PvEfhdpFgcXrdYsCQp0CMPZnhXTPEhuPk+mX271uul/qTYZfxnjq33nNjn3fkSrm9ecv7xI/Nxje0DPAw+9FfO8mdq9r7qcrzw2Gq9duKYwO3xfzetX6fbweJsPegUdfRoHv0ZEu4nWU9u+kfnhI6gx7Tz9TSDr3fUfK6vUEQPv7iJOA6Az9K/7EKPB9R8rwOjwkamL3lzH9BtRDZ0j8FPM49j2yGd3rBIXSmab7n0g7rHXAte+pY5rudRKFFovv6XoEsdYB575v17wujHOybPPw2kux+y+uHQ6hMxA9OK/xuPR9AfkTnIcI+BRF4bbo5OGjxw6ewraANAYROXJqS2gysBvfB4wIIZOA169b05GlaBei3Lo10sYaA7Ant97gAYCYES4OAMSITR930l0hVs6qSInBAJDBYwF1skRE8lbTL+6d7cFufRtDIR5mUXHabYvWYVutbze94+FPtZo+CXzhO7r1i5jeeSYXM/0zjWFkpndTWYqZvjq3j6lqhKZ3Ykur6RNQpX4IKh1hh+2k27aanuCl2gJiwchM76Tbtpm+JuEh1RGQpEZoeqfd9hOZWaqQyYYQGqHpnXbbdHpdi8K0eDMqgDWut92RbnpeG21eHleAgBgiyzdHRUzv+BDkjx/WfW5WAP0FwMdtpnd9YWOBI83nLEYFMCqBsN30rodYP0oAYpCIWNFGwRJjQCOACAwKy4Dgx5AD"},null,-1),Y=M("h1",null,"model-asset-preview",-1),k={key:0},O=M("h2",null,"Quality:",-1),q=M("option",{value:"1"},"1x",-1),F=M("option",{value:"2"},"2x",-1),L=M("option",{value:"3"},"3x",-1),z=M("option",{value:"4"},"4x",-1),C=M("h2",null,"Model:",-1),B=M("h2",null,"Texture:",-1),D={key:1};j(m({expose:[],setup(e){const t=w(void 0);async function a(e){var a;const i=e.target,s=null==(a=null==i?void 0:i.files)?void 0:a[0];if(!s)return;const n=JSON.parse(await s.text());if(n["minecraft:geometry"])t.value=n["minecraft:geometry"][0];else{const e=Object.values(n)[0],a={description:{},bones:[]};a.description.texture_width=e.texturewidth,a.description.texture_height=e.textureheight,a.bones=e.bones,t.value=a}}const i=w(void 0);async function s(e){var t;const a=e.target,s=null==(t=null==a?void 0:a.files)?void 0:t[0];if(!s)return;const n=new FileReader;n.addEventListener("load",(()=>{"string"==typeof n.result&&(i.value=n.result)})),n.addEventListener("error",(e=>console.error(e))),n.readAsDataURL(s)}const n=w("4"),r=p((()=>Number(n.value)));function o(){t.value=void 0,i.value=void 0}const h=p((()=>!!t.value&&!!i.value));return(e,l)=>(v(),f(x,null,[A,Y,R(h)?(v(),f("p",D,"Loading...")):(v(),f("div",k,[O,P(M("select",{"onUpdate:modelValue":l[1]||(l[1]=e=>n.value=e)},[q,F,L,z],512),[[y,n.value]]),C,M("input",{type:"file",onChange:a},null,32),B,M("input",{type:"file",onChange:s},null,32)])),R(h)?(v(),f(E,{key:2,model:t.value,texture:i.value,quality:R(r),onReady:o},null,8,["model","texture","quality"])):I("",!0)],64))}})).mount("#app");
